<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Lookup table maintenance in Hive &middot; Kirill Pavlov</title>

  
  <link rel="stylesheet" href="http://kirillpavlov.com/css/poole.css">
  <link rel="stylesheet" href="http://kirillpavlov.com/css/hyde.css">
  <link rel="stylesheet" href="http://kirillpavlov.com/css/poole-overrides.css">
  <link rel="stylesheet" href="http://kirillpavlov.com/css/hyde-overrides.css">
  <link rel="stylesheet" href="http://kirillpavlov.com/css/hyde-x.css">
  <link rel="stylesheet" href="http://kirillpavlov.com/css/highlight/zenburn.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://kirillpavlov.com/touch-icon-144-precomposed.png">
  <link href="http://kirillpavlov.com/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="Often analysts would use lookup tables for data manipulation. It is common, that such tables are maintained manually. This post reveals how to make this process easy and yet flexible using Hadoop and Hive external tables and views.">
  <meta name="keywords" content="hive,csv,maintenance,lookup">
  
</head>
<body class="theme-base-0b">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="https://www.gravatar.com/avatar/4ad1cf8cf3515355e570a73a1cfca54e?s=200" alt="gravatar">
      <h1>Kirill Pavlov</h1>
      <p class="lead">Let&rsquo;s change the world together!</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="http://kirillpavlov.com/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="http://kirillpavlov.com/about/">About Me</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/pavlov99"><i class="fa fa-github-square fa-3x"></i></a>
      
      <a href="https://www.linkedin.com/in/pavlov99"><i class="fa fa-linkedin-square fa-3x"></i></a>
      
      
      <a href="http://twitter.com/pavlov99"><i class="fa fa-twitter-square fa-3x"></i></a>
      
      
      </li>
    </ul>

    <p>Copyright &copy; 2016 <a href="http://kirillpavlov.com/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1>Lookup table maintenance in Hive</h1>
    <span class="post-date">Sep 7, 2016 &middot; 2 minute read &middot; <a href="http://kirillpavlov.com/blog/2016/09/07/lookup-table-maintenance-in-hive/#disqus_thread">Comments</a>
    
    <br/>
    <a class="label" href="http://kirillpavlov.com/categories/hive">hive</a><a class="label" href="http://kirillpavlov.com/categories/infrastructure">infrastructure</a><a class="label" href="http://kirillpavlov.com/categories/maintenance">maintenance</a>
    </span>
    <p>Lookup table is a translation table, aimed to enrich and extend base data.
Such tables are very common, especially in data warehousing (schema normalization) and business analytics area.
Usually they are mainteined manually and developers are constantly looking for the ways to simplify this process.</p>

<p>Let&rsquo;s consider an example: base table consists of <a href="http://sharks.nhl.com/club/page.htm?id=81102">San Jose Sharks 2016-2017 NHL season schedule</a>.
The goal is to analyze, how many games are played against each of four divisions teams.</p>


<figure >
    
        <img src="/images/san-jose-nhl-schedule-2016-2017-example.png" alt="data example" />
    
    
</figure>



<p>This table is located in a database already, but there is no information about divisions.
If data is small, then one can use SQL expression &ldquo;if team == xxx then division = yyy&rdquo;
However this is not the case. There are 30 teams and nobody would write such big query.
A way to go is to manually create small table and join it with original data. The other question is in maintenance â€“ even small data needs to be updated time to time. One of the best tool to use for lookup data manipulation is Excel because it exists nearly everywhere and a lot of people know how to work with it. Data from Excel is exported to csv and uploaded to Hadoop. This is a general idea, lets talk about the details.</p>

<p>Full lookup table in Excel looks like</p>


<figure >
    
        <img src="/images/lookup-example-nhl-teams.png" alt="lookup table example" />
    
    
</figure>



<p>Example of base data and lookup (shop transactions and product categories)</p>

<p>Could we do if-when? It is easier to use table.</p>

<p>How to upload such table? How to maintain? Excel and dump to csv.</p>

<p>csv with schema, better to use hive and external table.</p>

<p>hive view.</p>

<p>Often such tables are maintaned manually. For example</p>

<p>Often analysts would use lookup tables for data manipulation. It is common, that such
tables are maintained manually in Excel.</p>

  </div>
  <div id="disqus_thread"></div>
</div>


<script type="text/javascript">
var disqus_shortname = "kirillpavlovcom";
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>



<script type="text/javascript">
    var disqus_shortname = "kirillpavlovcom";
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script src="http://kirillpavlov.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
  var _gaq=[['_setAccount','UA-48154141-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>

